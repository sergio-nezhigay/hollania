import{_ as k}from"./preload-helper.41c905a7.min.js";import{i as r}from"./isNullOrUndefined.f9fb1932.min.js";import{P as x,a as B}from"./PUB_SUB_EVENTS.3b331125.min.js";import{f as N}from"./fetchSections.f98a5208.min.js";import z from"./fetchCartData.48e623df.min.js";import{M}from"./MEDIA_BREAKPOINTS.c5fda635.min.js";import{t as q}from"./dataLayer.b9c8aded.min.js";const R=new x,V=B.product,U="static__cart-bubble",$="static__side-cart";(()=>{M.XL_UP.matches&&k(()=>import("./ThumbnailsScrollable.f8b1a6f4.min.js"),["./ThumbnailsScrollable.f8b1a6f4.min.js","./debounce.0da8d65a.min.js"],import.meta.url);const a=document.querySelector(".shopify-product-form");if(r(a))return;const u=a.querySelector("[data-size-select]"),A=a.querySelector("[data-size-width-select]"),P=a.querySelectorAll('[name="color"]'),G=a.querySelectorAll('[name="style"]'),S=a.querySelector("[data-color-title-display]"),_=a.querySelector("[data-variant-input]"),v=a.querySelector("[data-out-of-stock-message]"),i=a.querySelector("[data-submit]"),p=a.querySelector("[data-submit-secondary]"),T=a.querySelector("[data-quantity-input]"),s=document.querySelector("[data-op-add-to-cart]"),m=document.querySelector("[data-size-info-text]"),y=t=>{const e=t.join("|"),o=window.PRODUCT_PAGE_DATA.product.variantsByOptions[e];if(!r(o))return window.PRODUCT_PAGE_DATA.product.variantsByOptions[e];console.log(`Variant not found for selector: ${e}. Will be replaced with first available variant by first option.`);let n=null;for(const c in window.PRODUCT_PAGE_DATA.product.variantsByOptions)if(c.includes(t[0])){console.log(`Found variant for selector: ${c}`),n=window.PRODUCT_PAGE_DATA.product.variantsByOptions[c];break}return r(n)?(console.log(`Variant not found for first option: ${t[0]}. Will be replaced with first available variant.`),window.PRODUCT_PAGE_DATA.product.variantsByOptions[0]):n},I=()=>{const t=document.querySelector(".jsProductPriceSection");t==null||t.classList.add("opacity-50"),N("product__price",`${window.location.href}&`).then(e=>{r(t)||(t.outerHTML=e.product__price,t.classList.remove("opacity-50"))})},E=()=>{var c,f,l;if(r(u))return;const t=(l=(f=(c=window.PRODUCT_PAGE_DATA)==null?void 0:c.optionalProduct)==null?void 0:f.variants)==null?void 0:l[u.value],e=document.querySelector("[data-op-c-variant-size]"),o=document.querySelector("[data-op-price]"),n=document.querySelector("[data-op-variant-id]");r(e)||r(t)||r(o)||r(n)||(e.innerText=t.option1.replaceAll("X","*"),o.innerText=String(t.price),n.dataset.opVariantId=String(t.id))},D=t=>{var n;const e=document.querySelector(".jsProductSlider");if(r(e))return;const o=Number(((n=e.querySelector(`[data-image-id="${t}"]`))==null?void 0:n.dataset.index)??-1);if(o!==-1){if(r(e.swiper)){window.onload=()=>e.swiper.slideTo(o,0,!1);return}e.swiper.slideTo(o,0,!1)}},b=()=>{var o;if(r(m))return;const e=(o=y(w()).metafields)==null?void 0:o.variant_info;if(r(e)){m.hidden=!0;return}m.hidden=!1,m.textContent=e},h=()=>{r(S)||P.forEach(t=>{t.checked&&(S.textContent=t.value)})},w=()=>{const t=[];return r(u)||t.push(u.value),r(A)||t.push(A.value),P.forEach(e=>{e.checked&&t.push(e.value)}),G.forEach(e=>{e.checked&&t.push(e.value)}),t},L=()=>{const t=y(w());window.history.replaceState({},"",`${window.location.origin}${window.location.pathname}?variant=${t.id}`),window.PRODUCT_PAGE_DATA.product.currentVariant.id=t.id,window.PRODUCT_PAGE_DATA.product.currentVariant.title=t.title,window.PRODUCT_PAGE_DATA.product.currentVariant.price=String(t.price),!r(_)&&(_.value=t.id.toString(),I(),E(),(()=>{const e=a.querySelector(`[name="style"][value="${t.option2}"]`);r(e)||(e.checked=!0)})(),h(),r(t.featured_media)||D(t.featured_media.id),b(),!(r(i)||r(p))&&(i.disabled=!t.available,p.disabled=!t.available,!r(v)&&v.classList.toggle("hidden",t.available)))},g=(t=!1)=>{var n;if(r(i)||r(_))return;const e=i.textContent;i.disabled=!0,i.textContent="מוסיף לעגלה...";const o=[{id:_.value,quantity:Number((T==null?void 0:T.value)??1)},...!r(s)&&s.checked?[{id:((n=s.dataset)==null?void 0:n.opVariantId)??"",quantity:1,properties:{_parent_variant_id:window.PRODUCT_PAGE_DATA.product.currentVariant.id}}]:[]];z(o,`${U},${$}`).then(c=>{var O;const f=document.querySelector("[data-cart-bubble]"),l=document.querySelector("[data-side-cart-container]");i.textContent="התווסף בהצלחה!",i.disabled=!1,setTimeout(()=>{i.textContent=e},3e3),r(f)||(f.innerHTML=c.sections[U]),r(l)||(l.innerHTML=c.sections[$],(O=l.closest("side-cart"))==null||O.updateInnerEls().open()),t&&(window.location.href="/checkout"),q("add_to_cart",{items:c.items.map(d=>({item_name:d.title,item_id:d.variant_id,price:String(d.final_price),quantity:d.quantity,item_category:d.collection_name,item_variant:d.variant_title,url:d.url}))})}).catch(c=>{console.error(c),i.textContent="Error!",i.disabled=!1})};a.addEventListener("change",t=>{var e,o;(t.target===u||t.target===A||((e=t.target)==null?void 0:e.name)==="color"||((o=t.target)==null?void 0:o.name)==="style")&&R.notify(V.VARIANT_CHANGE)}),i==null||i.addEventListener("click",t=>{t.preventDefault(),g()}),p==null||p.addEventListener("click",t=>{t.preventDefault(),g(!0)}),s==null||s.addEventListener("change",()=>{const t=s.closest("[data-toggle]");if(!r(t)){if(s.checked){t.classList.remove("border-grey-300"),t.classList.add("border-brand-600");return}t.classList.add("border-grey-300"),t.classList.remove("border-brand-600")}}),R.subscribe(V.VARIANT_CHANGE,L),(()=>{const t=document.querySelector("[data-info-accordion]");r(t)||t.querySelectorAll("read-more").forEach(e=>{e.callback=()=>{const o=e.closest("[data-target]");r(o)||t.openTarget(o.dataset.target??"")}})})(),E(),b(),h();const C=y(w());r(C.featured_media)||D(C.featured_media.id),q("view_item",{items:[{item_name:window.PRODUCT_PAGE_DATA.product.title,url:window.PRODUCT_PAGE_DATA.product.url,item_id:window.PRODUCT_PAGE_DATA.product.id,item_category:window.PRODUCT_PAGE_DATA.product.collections,item_variant:window.PRODUCT_PAGE_DATA.product.currentVariant.title,price:window.PRODUCT_PAGE_DATA.product.currentVariant.price,quantity:1}]})})();
